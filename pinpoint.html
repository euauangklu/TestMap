<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pinpoint SDK Map</title>
    
    <link href="https://unpkg.com/maplibre-gl@3.6.0/dist/maplibre-gl.css" rel="stylesheet" />

    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; overflow: hidden; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        .info-box {
            position: absolute; top: 20px; left: 20px; z-index: 100;
            background: white; padding: 15px; border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2); max-width: 300px;
        }
        .back-btn { display: inline-block; margin-bottom: 10px; text-decoration: none; color: #333; font-weight: bold; }
    </style>
    
    <script src="https://pin-point.co/g/sdk/1.0.7?key=b17531c1a81a64ba7e13f3157c10ad30c0489b98cb81dadeb87b19f3dc6626fe56d02565b6ed4eb2"></script>
</head>
<body>

    <div class="info-box">
        <a href="index.html" class="back-btn">⬅ กลับหน้าหลัก</a>
        <h3>Pinpoint Map (SDK Method)</h3>
        <p>ใช้วิธีโหลดผ่าน SDK โดยตรง</p>
        <div id="status" style="color:blue;">กำลังโหลด...</div>
    </div>

    <div id="map"></div>

    <script>
        // รอให้ SDK โหลดเสร็จ
        window.onload = function() {
            try {
                // ตรวจสอบว่า SDK โหลดมาจริงไหม
                if (typeof maplibregl === 'undefined') {
                    document.getElementById('status').innerText = "Error: โหลด Pinpoint SDK ไม่สำเร็จ";
                    return;
                }

                // สร้างแผนที่
                const map = new maplibregl.Map({
                    container: 'map',
                    // ✅ ใช้ Style URL แบบมาตรฐานของ Pinpoint (ใส่ Key กำกับอีกทีเพื่อความชัวร์)
                    style: `https://pin-point.co/maps/v1/styles/osm_bright.json?key=b17531c1a81a64ba7e13f3157c10ad30c0489b98cb81dadeb87b19f3dc6626fe56d02565b6ed4eb2`,
                    center: [100.5018, 13.7563], // กรุงเทพฯ
                    zoom: 12
                });

                map.addControl(new maplibregl.NavigationControl());

                map.on('load', () => {
                    document.getElementById('status').innerText = "✅ โหลดสำเร็จ!";
                    document.getElementById('status').style.color = "green";
                });

                map.on('error', (e) => {
                    console.error(e);
                    document.getElementById('status').innerText = "❌ เกิดข้อผิดพลาด (ดู Console)";
                    document.getElementById('status').style.color = "red";
                });

            } catch (error) {
                console.error("Critical Error:", error);
                document.getElementById('status').innerText = "Crash: " + error.message;
                document.getElementById('status').style.color = "red";
            }
        };
    </script>
</body>
</html>